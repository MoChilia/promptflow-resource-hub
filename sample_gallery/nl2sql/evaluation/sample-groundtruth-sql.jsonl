{"user_query":"Show the first name and the email address of customer with CompanyName 'Bike World'", "actual_sql":"SELECT firstname, emailaddress FROM SalesLT.Customer WHERE companyname = 'Bike World'"}
{"user_query":"Give the CompanyName of those customers with orders over $100000. Include the subtotal plus tax plus freight", "actual_sql":"SELECT companyname FROM SalesLT.Customer c JOIN SalesLT.SalesOrderHeader sh ON c.customerid = sh.customerid WHERE subtotal + taxamt + freight > 100000"}
{"user_query":"Show the SalesOrderID and the UnitPrice for every Single Item Order", "actual_sql":"WITH temp1 AS (SELECT salesorderid, SUM(OrderQty) AS items FROM SalesLT.SalesOrderDetail GROUP BY salesorderid HAVING SUM(OrderQty) = 1) SELECT salesorderid, unitprice FROM SalesLT.SalesOrderDetail WHERE salesorderid IN (SELECT salesorderid FROM temp1)"}
{"user_query":"Show the product description for culture 'fr' for product with ProductID 736", "actual_sql":"SELECT description FROM SalesLT.Product p JOIN SalesLT.ProductModel pm ON p.productmodelid = pm.productmodelid JOIN SalesLT.ProductModelProductDescription pmpd ON pm.productmodelid = pmpd.productmodelid JOIN SalesLT.ProductDescription pd ON pmpd.productdescriptionid = pd.productdescriptionid WHERE (productid = 736) AND (culture = 'fr')"}
{"user_query":"How many products in ProductCategory 'Cranksets' have been sold to an address in 'London'?", "actual_sql":"SELECT SUM(orderqty) total FROM SalesLT.Address a JOIN SalesLT.SalesOrderHeader sh ON a.addressid = sh.billtoaddressid JOIN SalesLT.SalesOrderDetail sd ON sh.salesorderid = sd.salesorderid JOIN SalesLT.Product p ON sd.productid = p.productid JOIN SalesLT.ProductCategory pc ON p.productcategoryid = pc.productcategoryid WHERE (city = 'London') AND (pc.name = 'Cranksets');"}
{"user_query":"For every customer with a 'Main Office' in Dallas show AddressLine1 of the 'Main Office' and AddressLine1 of the 'Shipping' address. If there is no shipping address leave it blank. Use one row per customer", "actual_sql":"SELECT companyname,   MAX(CASE WHEN addresstype = 'Main Office' THEN addressline1 ELSE '' END) main_office,   MAX(CASE WHEN addresstype = 'Shipping' THEN addressline1 ELSE '' END) shipping FROM SalesLT.CustomerAddress ca JOIN SalesLT.Address a ON ca.addressid = a.addressid JOIN SalesLT.Customer c ON ca.customerid = c.customerid WHERE city = 'Dallas' GROUP BY companyname"}
{"user_query":"Show the best selling item by value", "actual_sql":"SELECT TOP 1 name, SUM(orderqty * unitprice) total_value FROM SalesLT.SalesOrderDetail sd JOIN SalesLT.Product p ON sd.productid = p.productid GROUP BY name ORDER BY total_value DESC"}
{"user_query":"Identify the three most important cities. Show the break down of top level product category against city", "actual_sql":"WITH temp1 AS (SELECT TOP 3 city, SUM(unitprice * orderqty) AS total_sales FROM SalesLT.SalesOrderDetail sd JOIN SalesLT.SalesOrderHeader sh ON sd.salesorderid = sh.salesorderid   JOIN SalesLT.Address a ON sh.shiptoaddressid = a.addressid GROUP BY city ORDER BY total_sales DESC) SELECT city, pc.name, SUM(unitprice * orderqty) total_sales FROM SalesLT.SalesOrderDetail sd JOIN SalesLT.SalesOrderHeader sh ON sd.salesorderid = sh.salesorderid JOIN SalesLT.Address a ON sh.shiptoaddressid = a.addressid JOIN SalesLT.Product p ON sd.productid = p.productid JOIN SalesLT.ProductCategory pc ON p.productcategoryid = pc.productcategoryid WHERE city IN (SELECT city FROM temp1) GROUP BY city, pc.name ORDER BY city, total_sales DESC"}
{"user_query":"Find the best customer in each region", "actual_sql":"WITH temp1 (countryregion, companyname, total_sales, rnk) AS (SELECT countryregion, companyname, SUM(subtotal) AS total_sales, RANK() OVER (PARTITION BY countryregion ORDER BY SUM(subtotal) DESC) rnk FROM SalesLT.Address a JOIN SalesLT.SalesOrderHeader sh ON a.addressid = sh.shiptoaddressid JOIN SalesLT.Customer c ON sh.customerid = c.customerid GROUP BY countryregion, companyname) SELECT countryregion, companyname, total_sales FROM temp1 WHERE rnk = 1"}
{"user_query":"Show the total order value for each CountryRegion. List by value with the highest first", "actual_sql":"SELECT countryregion, SUM(subtotal) total FROM SalesLT.Address a JOIN SalesLT.SalesOrderHeader sh ON a.addressid = sh.shiptoaddressid GROUP BY countryregion"}